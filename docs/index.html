---

title: Github OrgStats


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">![</span>CI<span class="o">](</span>https://github.com/Living-with-machines/gh_orgstats/workflows/CI/badge.svg<span class="o">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>ghOrgReport</code> is intended to provide some easy ways of getting stats for a GitHub org. <code>ghOrgReport</code> does this by wrapping some functions around <a href="https://github.com/PyGithub/PyGithub">PyGithub</a>. This code is mainly intended to help generate reports as part of a GitHub actions pipeline to update stats for a funder. #TODO add link to lwm report</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To use <code>PyGithub</code> we need to authenticate with GitHub this is done via a token. This token is used to authenticate access and requires at least scope for public repos. See <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a> to register a token.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case we use <code>dotenv</code> to load the token from a <code>.env</code> files.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">load_dotenv</span><span class="p">()</span>
<span class="n">GH_TOKEN</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GH_TOKEN&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Currently all functionality is contained within the <a href="/gh_orgstats/stats.html"><code>stats</code></a> module.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">gh_orgstats.stats</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/gh_orgstats/stats.html#OrgStats"><code>OrgStats</code></a> class is used to get stats for a GitHub organization. To create an instance of this class we need to pass a GitHub token to authenticate and the name of the Organization you want stats for.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span> <span class="o">=</span> <span class="n">OrgStats</span><span class="p">(</span><span class="n">GH_TOKEN</span><span class="p">,</span> <span class="s2">&quot;ghorgstatstestorg&quot;</span><span class="p">)</span>
<span class="n">test_org</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>OrgStats: ghorgstatstestorg </pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Organization-repositories">Organization repositories<a class="anchor-link" href="#Organization-repositories"> </a></h3><p>As a start we can grab the repositories for an organization via the <a href="/gh_orgstats/stats.html#repos"><code>repos</code></a> attribute of our OrgStats instance</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">repos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Repository(full_name=&#34;ghorgstatstestorg/repo1&#34;),
 Repository(full_name=&#34;ghorgstatstestorg/repo2&#34;),
 Repository(full_name=&#34;ghorgstatstestorg/private_repo_1&#34;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also get a sense of what is in the repository by looking at the file extensions for each repository.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Repository-file-types">Repository file types<a class="anchor-link" href="#Repository-file-types"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">get_org_file_ext_frequency</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;repo1&#39;: {&#39;.md&#39;: 1},
 &#39;repo2&#39;: {&#39;.md&#39;: 1, &#39;.py&#39;: 1},
 &#39;private_repo_1&#39;: {&#39;.md&#39;: 1}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Filtering-by-publication-status">Filtering by publication status<a class="anchor-link" href="#Filtering-by-publication-status"> </a></h4><p>We can also filter this by publication status</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">get_org_file_ext_frequency</span><span class="p">(</span><span class="n">pub_status</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;repo1&#39;: {&#39;.md&#39;: 1}, &#39;repo2&#39;: {&#39;.md&#39;: 1, &#39;.py&#39;: 1}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Snapshot-stats">Snapshot stats<a class="anchor-link" href="#Snapshot-stats"> </a></h3><p>Snapshot stats are captured based on the current view and aren't updated. These include forks and clones</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">snapshot_stats</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stars</th>
      <th>forks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>repo1</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>repo2</th>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Traffic-stats">Traffic stats<a class="anchor-link" href="#Traffic-stats"> </a></h3><p>We can also get a longer view by using traffic stats for views and clones</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">get_org_views_traffic</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s1">&#39;readme_dir&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/gh_orgstats/stats.html#get_org_views_traffic"><code>get_org_views_traffic</code></a> will grab data via the GitHub api and update a CSV for each repository under the organization (by default only public) with views counts. This is largely intended to be used to semi-regularly update these stats by running this code as part of a GitHub Action or cron job.</p>
<p>If you want to load a DataFrame of traffic you can pass <code>load=True</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">get_org_views_traffic</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s1">&#39;readme_dir&#39;</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#34;|                     |   (&#39;repo1&#39;, &#39;total_views&#39;) |   (&#39;repo1&#39;, &#39;unique_views&#39;) |   (&#39;repo2&#39;, &#39;total_views&#39;) |   (&#39;repo2&#39;, &#39;unique_views&#39;) |\n|:--------------------|---------------------------:|----------------------------:|---------------------------:|----------------------------:|\n| 2020-11-30 00:00:00 |                          2 |                           1 |                          8 |                           1 |\n| 2020-12-01 00:00:00 |                          1 |                           1 |                        nan |                         nan |&#34;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly the same can be done for clones</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_org</span><span class="o">.</span><span class="n">get_org_clones_traffic</span><span class="p">(</span><span class="n">save_dir</span><span class="o">=</span><span class="s1">&#39;readme_dir&#39;</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">repo1</th>
      <th colspan="2" halign="left">repo2</th>
    </tr>
    <tr>
      <th></th>
      <th>total_clones</th>
      <th>unique_clones</th>
      <th>total_clones</th>
      <th>unique_clones</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-11-30</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

